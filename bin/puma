#! /usr/bin/python

import sys, os
sys.path.append(os.environ["HOME"] + '/novatools/puma/lib')
import puma
puma = puma.Puma()
from optparse import OptionParser
parser = OptionParser()


class CLI:
    def launch(self, arg):
        puma.run_instance(arg)

    def list(self, arg):
        if arg == "images":
            for image in puma.get_image_list():
                print image
        if arg == "instances":
            for instance in puma.get_instance_list():
                print instance.id, "\t", instance.image_id, "\t", instance.instance_type, "\t", instance.state


cli = CLI()

(options, args) = parser.parse_args()
if args[0] == "list":
    if args[1] == "images":
        cli.list("images")
    elif args[1] == "instances":
        cli.list("instances")
    else:
        print "ERROR: Not a valid expression " + '"' + str(args[0]), str(args[1]) + '"'

elif args[0] == "launch":
    cli.launch(args[1])

else:
    print "ERROR: Not a valid expression " + '"' + str(args[0]) + '"'
